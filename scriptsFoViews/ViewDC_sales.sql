CREATE ALGORITHM=UNDEFINED DEFINER=`cFullUserPW`@`%` SQL SECURITY DEFINER VIEW `DC_sales` AS 

select `DC_b`.`scenarioID` AS `scenarioID`,`DC_b`.`countryID` AS `countryID`,`DC_b`.`deviceID` AS `deviceID`,`DC_b`.`transFlag` AS `transFlag`,

sum(((((((`DC_b`.`Y2006g` - `DC_b`.`Y2005g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2005g` - `DC_b`.`Y2004g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2004g` - `DC_b`.`Y2003g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2003g` - `DC_b`.`Y2002g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2006`,
sum(((((((`DC_b`.`Y2007g` - `DC_b`.`Y2006g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2006g` - `DC_b`.`Y2005g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2005g` - `DC_b`.`Y2004g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2004g` - `DC_b`.`Y2003g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2007`,
sum(((((((`DC_b`.`Y2008g` - `DC_b`.`Y2007g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2007g` - `DC_b`.`Y2006g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2006g` - `DC_b`.`Y2005g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2005g` - `DC_b`.`Y2004g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2008`,
sum(((((((`DC_b`.`Y2009g` - `DC_b`.`Y2008g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2008g` - `DC_b`.`Y2007g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2007g` - `DC_b`.`Y2006g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2006g` - `DC_b`.`Y2005g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2009`,
sum(((((((`DC_b`.`Y2010g` - `DC_b`.`Y2009g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2009g` - `DC_b`.`Y2008g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2008g` - `DC_b`.`Y2007g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2007g` - `DC_b`.`Y2006g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2010`,
sum(((((((`DC_b`.`Y2011g` - `DC_b`.`Y2010g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2010g` - `DC_b`.`Y2009g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2009g` - `DC_b`.`Y2008g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2008g` - `DC_b`.`Y2007g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2011`,
sum(((((((`DC_b`.`Y2012g` - `DC_b`.`Y2011g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2011g` - `DC_b`.`Y2010g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2010g` - `DC_b`.`Y2009g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2009g` - `DC_b`.`Y2008g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2012`,
sum(((((((`DC_b`.`Y2013g` - `DC_b`.`Y2012g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2012g` - `DC_b`.`Y2011g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2011g` - `DC_b`.`Y2010g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2010g` - `DC_b`.`Y2009g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2013`,
sum(((((((`DC_b`.`Y2014g` - `DC_b`.`Y2013g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2013g` - `DC_b`.`Y2012g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2012g` - `DC_b`.`Y2011g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2011g` - `DC_b`.`Y2010g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2014`,
sum(((((((`DC_b`.`Y2015g` - `DC_b`.`Y2014g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2014g` - `DC_b`.`Y2013g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2013g` - `DC_b`.`Y2012g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2012g` - `DC_b`.`Y2011g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2015`,
sum(((((((`DC_b`.`Y2016g` - `DC_b`.`Y2015g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2015g` - `DC_b`.`Y2014g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2014g` - `DC_b`.`Y2013g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2013g` - `DC_b`.`Y2012g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2016`,
sum(((((((`DC_b`.`Y2017g` - `DC_b`.`Y2016g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2016g` - `DC_b`.`Y2015g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2015g` - `DC_b`.`Y2014g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2014g` - `DC_b`.`Y2013g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2017`,
sum(((((((`DC_b`.`Y2018g` - `DC_b`.`Y2017g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2017g` - `DC_b`.`Y2016g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2016g` - `DC_b`.`Y2015g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2015g` - `DC_b`.`Y2014g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2018`,
sum(((((((`DC_b`.`Y2019g` - `DC_b`.`Y2018g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2018g` - `DC_b`.`Y2017g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2017g` - `DC_b`.`Y2016g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2016g` - `DC_b`.`Y2015g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2019`,
sum(((((((`DC_b`.`Y2020g` - `DC_b`.`Y2019g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2019g` - `DC_b`.`Y2018g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2018g` - `DC_b`.`Y2017g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2017g` - `DC_b`.`Y2016g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2020`,
sum(((((((`DC_b`.`Y2021g` - `DC_b`.`Y2020g`) * (0 = `DC_b`.`transFlag`)) + ((`DC_b`.`Y2020g` - `DC_b`.`Y2019g`) * (10 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2019g` - `DC_b`.`Y2018g`) * (20 = `DC_b`.`transFlag`))) + ((`DC_b`.`Y2018g` - `DC_b`.`Y2017g`) * (30 = `DC_b`.`transFlag`))) * `DC_b`.`coef`)) AS `Y2021` 

from `DC_b` group by `DC_b`.`scenarioID`,`DC_b`.`countryID`,`DC_b`.`deviceID`